{
  "hash": "f47bf9ed3a6f59275bbb231a29592e6e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"對長條圖感到厭煩？何不試試棒棒糖圖(Lollipop chart)\"\ndate: \"2024-09-17\"\ndescription: \"簡介棒棒糖圖(Lollipop chart)，告訴你什麼時候可以使用，並用ggplot2繪製它。\"\ncategories: [R, ggplot]\nformat: \n  html:\n    toc: true\neditor: visual\n---\n\n\n\n我常常繪製統計圖表，常常使用長條圖，但偶爾會對長條圖感到厭煩。所以我試著尋找比較少見，而且能替代長條圖功能的圖形。棒棒糖圖(lollipop chart)是我對長條圖感到厭倦時的解藥。\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n# 什麼是棒棒糖圖(Lollipop chart)？\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lollipop_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n棒棒糖圖與一般常見的長條圖在功能方面是完全一樣的，都是用來比較不同的種類或不同時間點間的數值差異。長條圖通常用「長條」的長度來表示數值的大小，棒棒糖圖則是用線段表示數值大小，並在末端加了一個點，因形似棒棒糖而得名。\n\n跟長條圖一樣存在著不同的變體，例如橫向的圖形：\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lollipop_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n也可以用來同時比較正數及負數：\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lollipop_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n有的時候還會看到有人利用末端的圓形放入數值標記：\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lollipop_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n# 什麼時候適合使用棒棒糖圖？\n\n適合使用棒棒糖圖的時機，我認為有下列兩個：\n\n-   太頻繁的使用長條圖的時候\n\n-   想要降低圖案佔統計圖表之比例的時候\n\n設想今天你寫了一份資料分析報告，裡面需要很多不同類別間的數量比較，長條圖肯定是最直觀的選擇。但如果整份報告向下方圖形一樣，充滿了長條圖，很容易讓讀者感到煩膩並對圖形感到疲勞，降低了我們想要透過圖形傳遞重要資訊的效果。\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lollipop_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n這時，棒棒糖圖是個可以替代長條圖的選擇。\n\n第二個使用時機是，當你要比較的種類很多，而且數值全部都很接近的時候。因為這時長條的圖案會佔你的整體圖表過多的比例，讓你的圖表變得很厚重：\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lollipop_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n你可以利用棒棒糖圖可以降低這種感覺，讓圖案的佔比下降：\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lollipop_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n# 使用ggplot繪製棒棒糖圖\n\n棒棒糖圖可以利用`ggplot2`的`geom_point`和`geom_segment`來畫，也就是用點和線段來組成棒棒糖的形狀。\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 範例資料\ndata <- data.frame(\n    type = LETTERS[1:15],\n    values = round(abs(rnorm(15, 40, 3)), 2)\n)\n\n# 繪製圖形\np <- data |> \n    ggplot(aes(x = type, y = values)) +\n    geom_point(size = 7, pch = 19, color = \"#41B3A2\") +\n    geom_segment(aes(x = type, xend = type, y = 0, yend = values),\n                 linewidth = 2, color = \"#41B3A2\") \np\n```\n\n::: {.cell-output-display}\n![](lollipop_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n-   `geom_segment`是用來畫出線段的，其中`x`、`xend`、`y`、`yend`指定的是你線段兩端點的座標。\n\n<br>\n\n**在圓點中標記數值**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- p + geom_text(aes(label = round(values, 1)),\n                   color = \"white\", size = 8, size.unit = \"pt\")\np\n```\n\n::: {.cell-output-display}\n![](lollipop_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n-   `geom_text`可以用來標記數值的，因為數值的位置和圓點一樣，所以`aes()`中不再設定`x`和`y`。`label`則是設定要標記的文字。\n\n<br>\n\n**繪製橫向棒棒糖圖**\n\n要繪製橫向棒棒糖圖，可以使用`coord_flip()`將兩軸翻轉來達成。\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np + coord_flip()\n```\n\n::: {.cell-output-display}\n![](lollipop_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n<br>\n\n**同時比較正數及負數**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata2 <- data.frame(\n    type = LETTERS[1:15],\n    values = rnorm(15, 0, 5)\n)\n\ndata2 |> \n    mutate(\n        c = as.factor(if_else(values >= 0, 0, 1))\n    ) |> \n    ggplot(aes(x = fct_reorder(type, desc(values)), \n               y = values, color = c)) +\n    geom_point(size = 3) +\n    geom_segment(aes(x = type, xend = type, y = 0, yend = values)) +\n    geom_hline(yintercept = 0) +\n    scale_color_manual(values = c(\"red\", \"grey\")) +\n    labs(x = \"type\") +\n    theme(\n        legend.position = \"none\",\n        axis.ticks.length = unit(0, \"mm\"),\n        axis.line.y = element_line(),\n        axis.text.y = element_text(size = 12),\n        panel.grid.minor = element_blank(),\n        panel.grid.major.x = element_blank(),\n        panel.grid.major.y = element_line(color = \"grey\", \n                                          linetype = \"dashed\"),\n        panel.background = element_blank()\n    ) \n```\n\n::: {.cell-output-display}\n![](lollipop_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n這張圖比較正負數的圖，比起前面的圖形多做了三件事：\n\n-   依大小排序。是將`type`這個變數依據`values`的值來設定level，利用`fct_reorder(type, desc(values)`來達成。\n\n-   將正值及負值加上不同的顏色。\n\n    -   用`mutate()`產生一個新變數`c`標記正負值，再依據其設定不同顏色(`aes()`中的`color = c`)。\n\n    -   `scale_color_manual(values = c(\"red\", \"grey\"))`則是手動設定顏色。\n\n-   用`geom_hline(yintercept = 0)`在0的位置加上水平線，作為比較的基準。\n\n<br>\n\n這次的介紹就到這裡，希望能幫到用膩了長條圖的你，謝謝。\n",
    "supporting": [
      "lollipop_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}